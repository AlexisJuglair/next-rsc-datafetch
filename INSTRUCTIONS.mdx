# Fetch dans un React Server Component

### 💡 Fetch RSC

## 📝 Tes notes

Détaille ce que tu as appris ici, sur une page [Notion](https://go.mikecodeur.com/course-notes-template)

## Comprendre

Un composant serveur dans `React` (React Server Component) est un type de composant qui s'exécute côté serveur. Il permet de rendre le contenu HTML à l'avance sur le serveur avant de l'envoyer au client. Cela améliore les performances et le SEO en permettant un rendu plus rapide des pages et une meilleure indexation par les moteurs de recherche. Les composants serveur peuvent accéder directement aux données du serveur, ce qui simplifie la gestion des données et réduit les requêtes client-serveur.

De base dans Next, tout les composants sont des React Serveur Components, sauf s’ils incluent la directive `“use client”`

Le grand avantage des RSC (React Server Component), c’est qu’il est possible de déclarer des composants `React` de manière asynchrone, ce qui simplifie la syntaxe.

```tsx
const Page = async () => {
		const data = await fetch('https/...')
		return (
			<>
			{data.map() ...
			</>
		)
	}
```

📑 Le lien vers la doc [https://react.dev/reference/rsc/server-components](https://react.dev/reference/rsc/server-components)

## Exercice

Avant de faire un `fetch` dans un React Server Component, nous allons voir comment nous pouvons utiliser l’api `use` de `React 19`.

📑 Le lien vers la doc [https://react.dev/reference/react/use](https://react.dev/reference/react/use)

```tsx
import { use } from 'react'

function Component() {
  const message = use(Promise)
```

**🐶 Dans cet exercice, tu vas devoir convertir le code utilisant le `fetch` et `useEffect` en le simplifiant avec `use`.**

Fichiers

- `exercises/post/page.tsx`

## Bonus

### 1. 🚀 Transforme ce RCC en RSC

**🐶** Supprime la directive `“use client”` du fichier pour transformer le RCC en RSC. Cela ne pose pas de problème car nous n’utilisons pas de Hook comme `useState` et `useEffect`. Regarde où sont loguées les datas.

<aside>
💡 Exécute un CURL et constate qu’en client comme en serveur, les données sont déjà là car `use`  s’exécute des 2 côtés.

</aside>

Fichiers

- `exercises/post/page.tsx`

### 2. 🚀 Fetch directement dans un RSC

Les RSC permettent d’utiliser du code `async` dans les composants. Comme `use` n’est pas recommandé pour `fetch` des datas dans un RSC, nous pouvons utiliser `fetch` directement dans les composants.

[https://react.dev/reference/react/use](https://react.dev/reference/react/use)

```tsx
When fetching data in a Server Component, prefer async and await over use. async and await pick up rendering from the point where await was invoked, whereas use re-renders the component after the data is resolved.
```

🐶 Transforme le RSC en composant `async` pour pouvoir appeler `fetch` directement.

Fichiers

- `exercise/about/page`

### 3. 🚀 Appeler directement la base de données

Pourquoi exposer une API REST faisant un appel à une base de données pour être consommée par un composant via `fetch` ?

Alors que grâce au RSC, on peut directement appeler la base de données ?

🐶 Dans cet exercice, supprime les appels `fetch` et appelle directement la base de données via la fonction `getPosts`.

```tsx
import {getPosts} from '@/db/sgbd'
```

## Aller plus loin

📑 Le lien vers la doc [https://react.dev/reference/rsc/server-components](https://react.dev/reference/rsc/server-components)

## Ils vont t’aider

- **🐶 Mowgli le Chien** : _Mowgli te guidera dans chaque exercice._
- **🤖 Ash le Robot** : _Ash le Robot te donnera du code utile._
- **🚀 Julia La roquette** : _Julia te donnera des défis supplémentaires._
- **⛏️ Hulk le Marteau** : _Quand du code à supprimer est présent_
- **👨‍✈️ Hugo le chef de projet** : _Va t'aider sur les spécifications du projet_

## 🐜 Feedback

Remplir le formulaire le [formulaire de FeedBack](https://go.mikecodeur.com/cours-next-avis?entry.1912869708=Next%20PRO&entry.1430994900=03.RSC%20Data%20fetch&entry.533578441=04%20Fetch%20RSC).
